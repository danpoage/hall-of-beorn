@using HallOfBeorn.Models
@model SearchViewModel

@{
    ViewBag.Title = "Lord of the Rings: The Card Game - Search";
}

<script src="/Scripts/jquery-1.8.2.js" ></script>
<script type="text/javascript">
    $(document).ready(function () {
        $('#resetButton').click(function () {
            $('#Query').val('');
            $('#CardSet').val('Any');
            $('#CardType').val('Any');
            $('#Sphere').val('Any');
            $('#Cost').val('-1');
            $('#Trait').val('Any');
            $('#Keyword').val('Any');
        });
    });
</script>

<h2>Search</h2>

@using (Html.BeginForm("Search", "Cards", FormMethod.Post))
{
    <div class="form-group">
        @Html.TextBoxFor(x => x.Query, new { style = "margin-right:2px;" })
        <input type="submit" value="Search" style="border-radius:8px;background-color:lightgray;" />
        <a id="resetButton" href="#" style="margin-left:40px;">Clear Filters</a>

        <div>
            <span style="display:inline-block;">
            @* @Html.LabelFor(x => x.CardSet, new { style = "display:inline;margin-right:2px;width:70px;" }) *@
            <span style="margin-right:2px;width:55px;display:inline-block;">Set</span>
            @Html.DropDownListFor(x => x.CardSet, SearchViewModel.CardSets, new { style = "margin-right:12px;max-width:170px;" })
            </span>

            <span style="display:inline-block;">
            @* @Html.LabelFor(x => x.CardType, new { style = "display:inline;margin-right:2px;width:70px;" }) *@
            <span style="margin-right:2px;width:55px;display:inline-block;">Type</span>
            @Html.DropDownListFor(x => x.CardType, SearchViewModel.CardTypes, new { style = "margin-right:12px;" })
            </span>

            <span style="display:inline-block;">
            @*@Html.LabelFor(x => x.Sphere, new { style = "display:inline;margin-right:2px;width:70px;" })*@
            <span style="margin-right:2px;width:55px;display:inline-block;">Sphere</span>
            @Html.DropDownListFor(x => x.Sphere, SearchViewModel.Spheres, new { style = "margin-right:12px;" })
            </span>

            <span style="display:inline-block;">
            @* @Html.LabelFor(x => x.Cost, new { style = "display:inline;margin-right:2px;width:70px;" }) *@
            <span style="margin-right:2px;width:55px;display:inline-block;">Cost</span>
            @Html.DropDownListFor(x => x.Cost, SearchViewModel.Costs, new { style = "margin-right:12px;" })


            @*@Html.LabelFor(x => x.Unique, new { style = "display:inline;margin-right:2px;" })*@
            <span style="margin-right:2px;width:55px;display:inline-block;">Unique</span>
            @Html.CheckBoxFor(x => x.Unique, new { style = "margin-right:12px;" })
            </span>
        </div>
        <div>
            <span style="display:inline-block;">
            @*@Html.LabelFor(x => x.Trait, new { style = "display:inline;margin-right:2px;width:70px;" })*@
            <span style="margin-right:2px;width:55px;display:inline-block;">Trait</span>
            @Html.DropDownListFor(x => x.Trait, SearchViewModel.Traits, new { style = "margin-right:12px;" })
            </span>

            <span style="display:inline-block;">
            @*@Html.LabelFor(x => x.Keyword, new { style = "display:inline;margin-right:2px;width:70px;" })*@
            <span style="margin-right:2px;width:55px;display:inline-block;">Keyword</span>
            @Html.DropDownListFor(x => x.Keyword, SearchViewModel.Keywords, new { style = "margin-right:12px;max-width:161px;" })
            </span>

            <span style="display:inline-block;">
            @*@Html.LabelFor(x => x.Sort, new { style = "display:inline;margin-right:2px;width:70px;" })*@
            <span style="margin-right:2px;width:55px;display:inline-block;">Sort</span>
            @Html.DropDownListFor(x => x.Sort, SearchViewModel.Sorts, new { style = "margin-right:0px;" })
            </span>
        </div>
    </div>
}

<div ">
@foreach (var card in @Model.Cards)
{
    <hr style="color:#616161;" />
    <div style="margin:6px;border: 0px solid gray;border-radius: 8px;min-height:200px;">
        <div style="margin-bottom:2px;">
            @if (@card.IsUnique)
            {
                <img src="/Images/unique.png" style="margin-bottom:-3px;margin-right:-4px;height:16px;width:16px;"/>
            }
            @Html.ActionLink(@card.FullTitle, "Details", new { id = @card.Slug }, new { style = "margin-bottom:2px;font-size:medium;font-weight:bold;" })
            <span style="display:inline-block;color:#616161;">@card.SetName</span>
            <span style="display:inline-block;">
            @if (@card.HasSphere)
            {
                <span><img style="width:30px;height:30px;margin-bottom:-4px;margin-left:2px;margin-right:1px;" src='@string.Format("/Images/{0}.png", @card.Sphere)' /></span>
            }
            @if (@card.HasEncounterSet)
            {
                <span><img style="width:30px;height:30px;margin-bottom:-4px;margin-left:2px;margin-right:1px;" src='@card.EncounterSetImagePath' /></span>
            }
            </span>
        </div>
        
        <div style="float:left;">
            <a href="@Href(string.Format("/Cards/Details/{0}", @card.Slug))">
                @if (@card.HasSecondImage)
                {
                    <span style="text-align:left;">
                        <img src="@card.ImagePath1" style="height:160px;"/>
                        <img src="@card.ImagePath2" style="height:160px;margin-left:4px;"/>
                    </span>
                }
                else
                {
                <img src="@card.ImagePath" style="height:160px;"/>
                }
            </a>
        </div>
        
        <div style="display:inline-block;margin-left:4px;min-width:30px;">
            @switch (@card.CardType)
            {
                case CardType.Hero:
                    <span style="color:#616161;">(</span><span style="margin-left:4px;margin-right:4px;font-weight:bold;">@card.ThreatCost</span><span style="color:#616161;">)</span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Willpower</span><img style="margin-bottom:-3px;" src="/Images/willpower.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Attack</span><img style="margin-bottom:-3px;" src="/Images/attack.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Defense</span><img style="margin-bottom:-3px;" src="/Images/defense.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.HitPoints</span><img style="margin-bottom:-4px;margin-left:-4px;width:20px;height:20px;" src="/Images/heart.png"/></span>
                    break;
                case CardType.Ally:
                    <span style="color:#616161;">(</span><span style="margin-left:4px;margin-right:4px;font-weight:bold;">@card.ResourceCost</span><span style="color:#616161;">)</span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Willpower</span><img style="margin-bottom:-3px;" src="/Images/willpower.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Attack</span><img style="margin-bottom:-3px;" src="/Images/attack.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Defense</span><img style="margin-bottom:-3px;" src="/Images/defense.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.HitPoints</span><img style="margin-bottom:-4px;margin-left:-4px;width:20px;height:20px;" src="/Images/heart.png"/></span>
                    break;
                case CardType.Attachment:
                    <span style="width:50px;color:#616161;">(</span><span style="margin-left:4px;margin-right:4px;font-weight:bold;">@card.ResourceCost</span><span style="color:#616161;">)</span>
                    break;
                case CardType.Event:
                    <span style="width:50px;color:#616161;">(</span><span style="margin-left:4px;margin-right:4px;font-weight:bold;">@card.ResourceCost</span><span style="color:#616161;">)</span>
                    break;
                case CardType.Treasure:
                    <span style="width:50px;color:#616161;">(</span><span style="margin-left:4px;margin-right:4px;font-weight:bold;">@card.ResourceCost</span><span style="color:#616161;">)</span>
                    break;
                case CardType.Enemy:
                    <span style="color:#616161;">(</span><span style="margin-left:4px;margin-right:4px;font-weight:bold;">@card.EngagementCost</span><span style="color:#616161;">)</span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Threat</span><img style="margin-bottom:-3px;" src="/Images/threat.png" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Attack</span><img style="margin-bottom:-3px;" src="/Images/attack.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Defense</span><img style="margin-bottom:-3px;" src="/Images/defense.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.HitPoints</span><img style="margin-bottom:-4px;margin-left:-4px;width:20px;height:20px;" src="/Images/heart.png"/></span>
                    break;
                case CardType.Location:
                    <span style="width:60px;color:#616161;">Quest Points</span><span style="margin-left:4px;font-weight:bold;">@card.QuestPoints</span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Threat</span><img style="margin-bottom:-3px;" src="/Images/threat.png" /></span>
                    break;
                case CardType.Objective:
                case CardType.Objective_Ally:
                    if (@card.CardType == CardType.Objective_Ally || @card.HasCharacterStats)
                    {
                    <span style="width:24px;"><span style="margin-right:2px;font-weight:bold;">@card.Willpower</span><img style="margin-bottom:-3px;" src="/Images/willpower.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Attack</span><img style="margin-bottom:-3px;" src="/Images/attack.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.Defense</span><img style="margin-bottom:-3px;" src="/Images/defense.gif" /></span>
                    <span style="width:24px;margin-left:14px;"><span style="margin-right:2px;font-weight:bold;">@card.HitPoints</span><img style="margin-bottom:-4px;margin-left:-4px;width:20px;height:20px;" src="/Images/heart.png"/></span>
                    }
                    break;
                case CardType.Quest:
                    <span style="width:40px;color:#616161;">Stage</span><span style="margin-left:4px;font-weight:bold;">@card.StageNumber</span>
                    <span style="width:40px;color:#616161;margin-left:14px;">Quest Points</span><span style="margin-left:4px;font-weight:bold;">@card.QuestPoints</span>
                    break;
                default:
                    break;
            }
        </div>
        <div style="margin-left:2px;vertical-align:top;text-align:left;">
            @foreach (var trait in card.Traits)
            {
                <i>@trait</i> @: &nbsp;
            }
            <br />
            @foreach (var keyword in card.Keywords)
            {
                @keyword @: &nbsp;
            }
            <br />
            @card.Text

            @if (!string.IsNullOrEmpty(@card.OppositeText))
            {
                <br />
                <hr style="margin-left:24px;margin-right:24px;"/>
                @card.OppositeText
            }
            @if (!string.IsNullOrEmpty(@card.Shadow))
            {
                <br />
                <hr style="margin-left:24px;margin-right:24px;"/>    
                @card.Shadow
            }
        </div>
    </div>
}
</div>
